<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="author" content="Alfonso Garcia-Caro">
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-2.2.3.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
    <link href='https://fonts.googleapis.com/css?family=Josefin+Sans:400,300,600,700|Roboto+Mono' rel='stylesheet' type='text/css'>
    <link href="//fsprojects.github.io/Fable/content/custom.css" rel='stylesheet' type='text/css'>
    <script src="//fsprojects.github.io/Fable/content/tips.js"></script>
    <link rel="stylesheet" type="text/css" href="//fsprojects.github.io/Fable/content/snippets.css" />
    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" />
    <script language="javascript" type="text/javascript">
      function init() {
          try {
            websocket = new WebSocket("ws://"+window.location.host+"/websocket");
            websocket.onmessage = function(evt) { location.reload(); };
          } catch(e) { /* For local development only */ }
      }
      window.addEventListener("load", init, false);
    </script>
    
  <title>L-system generator - F# |> BABEL</title>
  <script src="../scripts/core.min.js"></script>
  <script src="../scripts/require.js"></script>
  
  <meta name="description" content="Interactive fractal generator">

</head>
<body>

  <div class="fb-navbar">
  <div class="container">
  <nav class="navbar navbar-default">
    <div class="navbar-wrapper">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="//fsprojects.github.io/Fable">Fable</a>
      </div>
      <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
        <ul class="nav navbar-nav">
          <li class=""><a href="//fsprojects.github.io/Fable">home</a></li>
          <li class="active"><a href="//fsprojects.github.io/Fable/samples.html">samples</a></li>
          <li class=""><a href="//fsprojects.github.io/Fable/docs.html">docs</a></li>
          <li><a href="https://github.com/fsprojects/Fable">source</a></li>
        </ul>
      </div>
    </div>
  </nav>
  </div>
  </div>

  <div class="fb-content-wrapper">
  
<div class="fb-heading">
<div class="container">
  <div class="row">
    <div class="col-sm-12">
      <h1>L-system generator</h1>
      <p>Interactive fractal generator</p>
    </div>
  </div>
</div>
</div>

<div class="container fb-content">
  <div class="row">
    <div class="col-md-1 col-lg-2"></div>
    <div class="col-sm-12 col-md-10 col-lg-8">
      <p><p> This demo is based on <a href="https://github.com/Andrea/Lsystem">L-system workshop</a> by Andrea Magnorsky
and Ross McKinlay. Rather than working on the tasks they gave us, I compiled it with Fable, so that you
can play with it in a browser!</p>
<p>The demo lets you enter a simple <a href="https://en.wikipedia.org/wiki/L-system">L-system</a> with a single
entry point and a number of rewriting rules written using <code>-&gt;</code>. You can use letters to draw a line
forward, <code>-</code> and <code>+</code> to turn (left and right) and <code>!</code> to randomly change color. It also supports
brackets, e.g. <code>[[-X]+X]</code>, for undoing state changes.</p></p>
    </div>
    <div class="col-md-1 col-lg-2"></div>
  </div>

  <div class="row">
    <div class="col-sm-12">
      <div class="app-container" style="width:600px; padding:20px 0px 10px 0px; margin:0px auto 0px auto;">
        
  <textarea id="input" style="width:600px;height:140px;font-family:'roboto mono',consolas,monospace">Y
Y -> ------X
X -> F[[[+FX]-FXF]---X]
F -> !FF</textarea><br />
  <table class="table" style="margin:10px 0px 20px 0px">
    <tr><th colspan="2">L-System Configuration</th></tr>
    <tr><td>Number of iterations (0 to 10):</td><td><input type="range" id="iterations" min="0" max="10" value="7"></td></tr>
    <tr><td>Rotation angle (0 to 180):</td><td><input type="range" id="angle" min="0" max="180" value="15"></td></tr>
    <tr><td>Line width (1 to 10):</td><td><input type="range" id="width" min="1" max="10" value="4"></td></tr>
  </table>

  <div id="errors">
  </div>
  <div id="output">
  </div>
  
      </div>
      <script>
        requirejs.config({
          baseUrl: '.',
          paths: { 'fable-core': '../scripts/fable-core.min',  }
        });
        requirejs(["lsystem"]);
      </script>
    </div>
  </div>

  <div class="row">
    <div class="col-md-1 col-lg-2"></div>
    <div class="col-sm-12 col-md-10 col-lg-8">
      <h2><a name="Rendering-fractals-with-SVG" class="anchor" href="#Rendering-fractals-with-SVG">Rendering fractals with SVG</a></h2>
<p>The demo uses SVG to render fractals. Once the fractal is generated, it is turned into a sequence
of lines that are then rendered. Each line has a starting and ending point together with a
color. We represent this using a simple F# domain model:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">type</span> <span onmouseout="hideTip(event, 'fs26', 47)" onmouseover="showTip(event, 'fs26', 47)" class="t">Point</span> <span class="o">=</span> { <span onmouseout="hideTip(event, 'fs27', 48)" onmouseover="showTip(event, 'fs27', 48)" class="i">x</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs28', 49)" onmouseover="showTip(event, 'fs28', 49)" class="t">float</span>; <span onmouseout="hideTip(event, 'fs29', 50)" onmouseover="showTip(event, 'fs29', 50)" class="i">y</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs28', 51)" onmouseover="showTip(event, 'fs28', 51)" class="t">float</span> }
<span class="k">type</span> <span onmouseout="hideTip(event, 'fs30', 52)" onmouseover="showTip(event, 'fs30', 52)" class="t">Color</span> <span class="o">=</span> { <span onmouseout="hideTip(event, 'fs31', 53)" onmouseover="showTip(event, 'fs31', 53)" class="i">r</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs32', 54)" onmouseover="showTip(event, 'fs32', 54)" class="t">int</span>; <span onmouseout="hideTip(event, 'fs33', 55)" onmouseover="showTip(event, 'fs33', 55)" class="i">g</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs32', 56)" onmouseover="showTip(event, 'fs32', 56)" class="t">int</span>; <span onmouseout="hideTip(event, 'fs34', 57)" onmouseover="showTip(event, 'fs34', 57)" class="i">b</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs32', 58)" onmouseover="showTip(event, 'fs32', 58)" class="t">int</span>; }
<span class="k">type</span> <span onmouseout="hideTip(event, 'fs35', 59)" onmouseover="showTip(event, 'fs35', 59)" class="t">LineSegment</span> <span class="o">=</span> {<span onmouseout="hideTip(event, 'fs36', 60)" onmouseover="showTip(event, 'fs36', 60)" class="i">startPoint</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs26', 61)" onmouseover="showTip(event, 'fs26', 61)" class="t">Point</span>; <span onmouseout="hideTip(event, 'fs37', 62)" onmouseover="showTip(event, 'fs37', 62)" class="i">endPoint</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs26', 63)" onmouseover="showTip(event, 'fs26', 63)" class="t">Point</span>; <span onmouseout="hideTip(event, 'fs38', 64)" onmouseover="showTip(event, 'fs38', 64)" class="i">color</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs30', 65)" onmouseover="showTip(event, 'fs30', 65)" class="t">Color</span> }
</code></pre></td>
</tr>
</table>
<p>When rendering lines, we generate <code>&lt;svg&gt;</code> tag containing a number of
<code>&lt;line&gt;</code> elements. This is done using a simple helper library (which you can find
<a href="https://github.com/fsprojects/Fable/blob/lsystems/samples/browser/lsystem/html.fs">in the Fable repository</a>).
The library uses the dynamic operator <code>?</code> to generate SVG elements. For example, you can write:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="i">s</span><span class="o">?</span><span class="i">svg</span> [ <span class="s">&quot;width&quot;</span> <span class="o">=&gt;</span> <span class="n">600</span> ] [
  <span class="i">s</span><span class="o">?</span><span class="i">line</span> [ <span class="s">&quot;x1&quot;</span> <span class="o">=&gt;</span> <span class="n">100</span>; <span class="s">&quot;y1&quot;</span> <span class="o">=&gt;</span> <span class="n">100</span>; <span class="s">&quot;x2&quot;</span> <span class="o">=&gt;</span> <span class="n">200</span>; <span class="s">&quot;y2&quot;</span> <span class="o">=&gt;</span> <span class="n">200</span> ]
]
</code></pre></td>
</tr>
</table>
<p>The result of <code>s?svg</code> is a function that takes a list of attributes and a list of nested elements.
Writing a rendering function is now easy - we just generate root SVG element with a line for each
<code>LineSegment</code>. The only slightly complex aspect is that we re-scale the image to fit into the
600x600 box automatically:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs39', 66)" onmouseover="showTip(event, 'fs39', 66)" class="f">render</span> <span onmouseout="hideTip(event, 'fs40', 67)" onmouseover="showTip(event, 'fs40', 67)" class="i">lineWidth</span> <span onmouseout="hideTip(event, 'fs41', 68)" onmouseover="showTip(event, 'fs41', 68)" class="i">lines</span> <span class="o">=</span>
  <span class="c">// Calculate minimal and maximal X/Y values for scaling</span>
  <span class="k">let</span> <span onmouseout="hideTip(event, 'fs42', 69)" onmouseover="showTip(event, 'fs42', 69)" class="i">xs</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs41', 70)" onmouseover="showTip(event, 'fs41', 70)" class="i">lines</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs43', 71)" onmouseover="showTip(event, 'fs43', 71)" class="t">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs44', 72)" onmouseover="showTip(event, 'fs44', 72)" class="f">collect</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs45', 73)" onmouseover="showTip(event, 'fs45', 73)" class="i">l</span> <span class="k">-&gt;</span> [<span onmouseout="hideTip(event, 'fs45', 74)" onmouseover="showTip(event, 'fs45', 74)" class="i">l</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs36', 75)" onmouseover="showTip(event, 'fs36', 75)" class="i">startPoint</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs27', 76)" onmouseover="showTip(event, 'fs27', 76)" class="i">x</span>; <span onmouseout="hideTip(event, 'fs45', 77)" onmouseover="showTip(event, 'fs45', 77)" class="i">l</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs37', 78)" onmouseover="showTip(event, 'fs37', 78)" class="i">endPoint</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs27', 79)" onmouseover="showTip(event, 'fs27', 79)" class="i">x</span>])
  <span class="k">let</span> <span onmouseout="hideTip(event, 'fs46', 80)" onmouseover="showTip(event, 'fs46', 80)" class="i">ys</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs41', 81)" onmouseover="showTip(event, 'fs41', 81)" class="i">lines</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs43', 82)" onmouseover="showTip(event, 'fs43', 82)" class="t">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs44', 83)" onmouseover="showTip(event, 'fs44', 83)" class="f">collect</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs45', 84)" onmouseover="showTip(event, 'fs45', 84)" class="i">l</span> <span class="k">-&gt;</span> [<span onmouseout="hideTip(event, 'fs45', 85)" onmouseover="showTip(event, 'fs45', 85)" class="i">l</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs36', 86)" onmouseover="showTip(event, 'fs36', 86)" class="i">startPoint</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs29', 87)" onmouseover="showTip(event, 'fs29', 87)" class="i">y</span>; <span onmouseout="hideTip(event, 'fs45', 88)" onmouseover="showTip(event, 'fs45', 88)" class="i">l</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs37', 89)" onmouseover="showTip(event, 'fs37', 89)" class="i">endPoint</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs29', 90)" onmouseover="showTip(event, 'fs29', 90)" class="i">y</span>])
  <span class="k">let</span> <span onmouseout="hideTip(event, 'fs47', 91)" onmouseover="showTip(event, 'fs47', 91)" class="i">minx</span>, <span onmouseout="hideTip(event, 'fs48', 92)" onmouseover="showTip(event, 'fs48', 92)" class="i">maxx</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs43', 93)" onmouseover="showTip(event, 'fs43', 93)" class="t">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs49', 94)" onmouseover="showTip(event, 'fs49', 94)" class="f">min</span> <span onmouseout="hideTip(event, 'fs42', 95)" onmouseover="showTip(event, 'fs42', 95)" class="i">xs</span>, <span onmouseout="hideTip(event, 'fs43', 96)" onmouseover="showTip(event, 'fs43', 96)" class="t">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs50', 97)" onmouseover="showTip(event, 'fs50', 97)" class="f">max</span> <span onmouseout="hideTip(event, 'fs42', 98)" onmouseover="showTip(event, 'fs42', 98)" class="i">xs</span>
  <span class="k">let</span> <span onmouseout="hideTip(event, 'fs51', 99)" onmouseover="showTip(event, 'fs51', 99)" class="i">miny</span>, <span onmouseout="hideTip(event, 'fs52', 100)" onmouseover="showTip(event, 'fs52', 100)" class="i">maxy</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs43', 101)" onmouseover="showTip(event, 'fs43', 101)" class="t">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs49', 102)" onmouseover="showTip(event, 'fs49', 102)" class="f">min</span> <span onmouseout="hideTip(event, 'fs46', 103)" onmouseover="showTip(event, 'fs46', 103)" class="i">ys</span>, <span onmouseout="hideTip(event, 'fs43', 104)" onmouseover="showTip(event, 'fs43', 104)" class="t">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs50', 105)" onmouseover="showTip(event, 'fs50', 105)" class="f">max</span> <span onmouseout="hideTip(event, 'fs46', 106)" onmouseover="showTip(event, 'fs46', 106)" class="i">ys</span>
  <span class="k">let</span> <span onmouseout="hideTip(event, 'fs53', 107)" onmouseover="showTip(event, 'fs53', 107)" class="f">convx</span> <span onmouseout="hideTip(event, 'fs54', 108)" onmouseover="showTip(event, 'fs54', 108)" class="i">x</span> <span class="o">=</span> (<span onmouseout="hideTip(event, 'fs54', 109)" onmouseover="showTip(event, 'fs54', 109)" class="i">x</span> <span class="o">-</span> <span onmouseout="hideTip(event, 'fs47', 110)" onmouseover="showTip(event, 'fs47', 110)" class="i">minx</span>) <span class="o">/</span> (<span onmouseout="hideTip(event, 'fs48', 111)" onmouseover="showTip(event, 'fs48', 111)" class="i">maxx</span> <span class="o">-</span> <span onmouseout="hideTip(event, 'fs47', 112)" onmouseover="showTip(event, 'fs47', 112)" class="i">minx</span>) <span class="o">*</span> <span class="n">600.0</span>
  <span class="k">let</span> <span onmouseout="hideTip(event, 'fs55', 113)" onmouseover="showTip(event, 'fs55', 113)" class="f">convy</span> <span onmouseout="hideTip(event, 'fs56', 114)" onmouseover="showTip(event, 'fs56', 114)" class="i">y</span> <span class="o">=</span> (<span onmouseout="hideTip(event, 'fs56', 115)" onmouseover="showTip(event, 'fs56', 115)" class="i">y</span> <span class="o">-</span> <span onmouseout="hideTip(event, 'fs51', 116)" onmouseover="showTip(event, 'fs51', 116)" class="i">miny</span>) <span class="o">/</span> (<span onmouseout="hideTip(event, 'fs52', 117)" onmouseover="showTip(event, 'fs52', 117)" class="i">maxy</span> <span class="o">-</span> <span onmouseout="hideTip(event, 'fs51', 118)" onmouseover="showTip(event, 'fs51', 118)" class="i">miny</span>) <span class="o">*</span> <span class="n">600.0</span>

  <span class="c">// Generate root SVG tag with line tag for each line sgement</span>
  <span onmouseout="hideTip(event, 'fs57', 119)" onmouseover="showTip(event, 'fs57', 119)" class="i">s</span><span class="o">?</span><span class="i">svg</span> [<span class="s">&quot;width&quot;</span> <span class="o">=&gt;</span> <span class="n">600</span>; <span class="s">&quot;height&quot;</span> <span class="o">=&gt;</span> <span class="n">600</span>] [
    <span class="k">for</span> <span onmouseout="hideTip(event, 'fs58', 120)" onmouseover="showTip(event, 'fs58', 120)" class="i">line</span> <span class="k">in</span> <span onmouseout="hideTip(event, 'fs41', 121)" onmouseover="showTip(event, 'fs41', 121)" class="i">lines</span> <span class="k">-&gt;</span>
      <span onmouseout="hideTip(event, 'fs57', 122)" onmouseover="showTip(event, 'fs57', 122)" class="i">s</span><span class="o">?</span><span onmouseout="hideTip(event, 'fs58', 123)" onmouseover="showTip(event, 'fs58', 123)" class="i">line</span>
        [ <span class="s">&quot;x1&quot;</span> <span class="o">=&gt;</span> <span onmouseout="hideTip(event, 'fs53', 124)" onmouseover="showTip(event, 'fs53', 124)" class="f">convx</span> <span onmouseout="hideTip(event, 'fs58', 125)" onmouseover="showTip(event, 'fs58', 125)" class="i">line</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs36', 126)" onmouseover="showTip(event, 'fs36', 126)" class="i">startPoint</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs27', 127)" onmouseover="showTip(event, 'fs27', 127)" class="i">x</span>; <span class="s">&quot;y1&quot;</span> <span class="o">=&gt;</span> <span onmouseout="hideTip(event, 'fs55', 128)" onmouseover="showTip(event, 'fs55', 128)" class="f">convy</span> <span onmouseout="hideTip(event, 'fs58', 129)" onmouseover="showTip(event, 'fs58', 129)" class="i">line</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs36', 130)" onmouseover="showTip(event, 'fs36', 130)" class="i">startPoint</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs29', 131)" onmouseover="showTip(event, 'fs29', 131)" class="i">y</span>
          <span class="s">&quot;x2&quot;</span> <span class="o">=&gt;</span> <span onmouseout="hideTip(event, 'fs53', 132)" onmouseover="showTip(event, 'fs53', 132)" class="f">convx</span> <span onmouseout="hideTip(event, 'fs58', 133)" onmouseover="showTip(event, 'fs58', 133)" class="i">line</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs37', 134)" onmouseover="showTip(event, 'fs37', 134)" class="i">endPoint</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs27', 135)" onmouseover="showTip(event, 'fs27', 135)" class="i">x</span>; <span class="s">&quot;y2&quot;</span> <span class="o">=&gt;</span> <span onmouseout="hideTip(event, 'fs55', 136)" onmouseover="showTip(event, 'fs55', 136)" class="f">convy</span> <span onmouseout="hideTip(event, 'fs58', 137)" onmouseover="showTip(event, 'fs58', 137)" class="i">line</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs37', 138)" onmouseover="showTip(event, 'fs37', 138)" class="i">endPoint</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs29', 139)" onmouseover="showTip(event, 'fs29', 139)" class="i">y</span>
          <span class="s">&quot;style&quot;</span> <span class="o">=&gt;</span>
            <span onmouseout="hideTip(event, 'fs59', 140)" onmouseover="showTip(event, 'fs59', 140)" class="f">sprintf</span> <span class="s">&quot;stroke:rgb(</span><span class="pf">%i</span><span class="s">,</span><span class="pf">%i</span><span class="s">,</span><span class="pf">%i</span><span class="s">);stroke-width:</span><span class="pf">%i</span><span class="s">&quot;</span>
              <span onmouseout="hideTip(event, 'fs58', 141)" onmouseover="showTip(event, 'fs58', 141)" class="i">line</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs38', 142)" onmouseover="showTip(event, 'fs38', 142)" class="i">color</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs31', 143)" onmouseover="showTip(event, 'fs31', 143)" class="i">r</span> <span onmouseout="hideTip(event, 'fs58', 144)" onmouseover="showTip(event, 'fs58', 144)" class="i">line</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs38', 145)" onmouseover="showTip(event, 'fs38', 145)" class="i">color</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs33', 146)" onmouseover="showTip(event, 'fs33', 146)" class="i">g</span> <span onmouseout="hideTip(event, 'fs58', 147)" onmouseover="showTip(event, 'fs58', 147)" class="i">line</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs38', 148)" onmouseover="showTip(event, 'fs38', 148)" class="i">color</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs34', 149)" onmouseover="showTip(event, 'fs34', 149)" class="i">b</span> <span onmouseout="hideTip(event, 'fs40', 150)" onmouseover="showTip(event, 'fs40', 150)" class="i">lineWidth</span> ] []
  ]
</code></pre></td>
</tr>
</table>
<h2><a name="From-turtle-graphics-to-line-sgemnets" class="anchor" href="#From-turtle-graphics-to-line-sgemnets">From turtle graphics to line sgemnets</a></h2>
<p>To make the evaluation of L-systems easier, we first turn L-system into commands of a simple
turtle graphics engine:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">type</span> <span onmouseout="hideTip(event, 'fs60', 151)" onmouseover="showTip(event, 'fs60', 151)" class="t">LogoCommand</span> <span class="o">=</span>
  | <span onmouseout="hideTip(event, 'fs61', 152)" onmouseover="showTip(event, 'fs61', 152)" class="p">DrawForward</span> <span class="k">of</span> <span onmouseout="hideTip(event, 'fs28', 153)" onmouseover="showTip(event, 'fs28', 153)" class="t">float</span>
  | <span onmouseout="hideTip(event, 'fs62', 154)" onmouseover="showTip(event, 'fs62', 154)" class="p">Turn</span> <span class="k">of</span> <span onmouseout="hideTip(event, 'fs28', 155)" onmouseover="showTip(event, 'fs28', 155)" class="t">float</span>
  | <span onmouseout="hideTip(event, 'fs63', 156)" onmouseover="showTip(event, 'fs63', 156)" class="p">Push</span>
  | <span onmouseout="hideTip(event, 'fs64', 157)" onmouseover="showTip(event, 'fs64', 157)" class="p">Pop</span>
  | <span onmouseout="hideTip(event, 'fs65', 158)" onmouseover="showTip(event, 'fs65', 158)" class="p">RandomColor</span>

<span class="k">type</span> <span onmouseout="hideTip(event, 'fs66', 159)" onmouseover="showTip(event, 'fs66', 159)" class="t">LTurtle</span> <span class="o">=</span>
  { <span onmouseout="hideTip(event, 'fs67', 160)" onmouseover="showTip(event, 'fs67', 160)" class="i">angle</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs28', 161)" onmouseover="showTip(event, 'fs28', 161)" class="t">float</span>
    <span onmouseout="hideTip(event, 'fs68', 162)" onmouseover="showTip(event, 'fs68', 162)" class="i">x</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs28', 163)" onmouseover="showTip(event, 'fs28', 163)" class="t">float</span>
    <span onmouseout="hideTip(event, 'fs69', 164)" onmouseover="showTip(event, 'fs69', 164)" class="i">y</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs28', 165)" onmouseover="showTip(event, 'fs28', 165)" class="t">float</span>
    <span onmouseout="hideTip(event, 'fs70', 166)" onmouseover="showTip(event, 'fs70', 166)" class="i">c</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs30', 167)" onmouseover="showTip(event, 'fs30', 167)" class="t">Color</span>}
</code></pre></td>
</tr>
</table>
<p>The <code>DrawForward</code> and <code>Turn</code> commands move the turtle forward or rotate it. The <code>Push</code> and <code>Pop</code>
commands are used to implement the brackets - <code>Push</code> stores the current state of the turtle and
<code>Pop</code> restores the previous state. Finally, <code>RandomColor</code> corresponds to <code>!</code> and changes the color
to a new, randomly generated one:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs71', 168)" onmouseover="showTip(event, 'fs71', 168)" class="i">chaos</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs72', 169)" onmouseover="showTip(event, 'fs72', 169)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs73', 170)" onmouseover="showTip(event, 'fs73', 170)" class="t">Random</span>()
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs74', 171)" onmouseover="showTip(event, 'fs74', 171)" class="f">randomColor</span>() <span class="o">=</span>
  { <span onmouseout="hideTip(event, 'fs31', 172)" onmouseover="showTip(event, 'fs31', 172)" class="i">r</span> <span class="o">=</span> (<span onmouseout="hideTip(event, 'fs71', 173)" onmouseover="showTip(event, 'fs71', 173)" class="i">chaos</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs75', 174)" onmouseover="showTip(event, 'fs75', 174)" class="f">Next</span> <span class="n">256</span>);
    <span onmouseout="hideTip(event, 'fs33', 175)" onmouseover="showTip(event, 'fs33', 175)" class="i">g</span> <span class="o">=</span> (<span onmouseout="hideTip(event, 'fs71', 176)" onmouseover="showTip(event, 'fs71', 176)" class="i">chaos</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs75', 177)" onmouseover="showTip(event, 'fs75', 177)" class="f">Next</span> <span class="n">256</span>);
    <span onmouseout="hideTip(event, 'fs34', 178)" onmouseover="showTip(event, 'fs34', 178)" class="i">b</span> <span class="o">=</span> (<span onmouseout="hideTip(event, 'fs71', 179)" onmouseover="showTip(event, 'fs71', 179)" class="i">chaos</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs75', 180)" onmouseover="showTip(event, 'fs75', 180)" class="f">Next</span> <span class="n">256</span>) }
</code></pre></td>
</tr>
</table>
<p>The interpreter of the turtle graphics needs to keep track of the current position and direction
of the turtle. It iterates over the commands one by one and either updates the current state or
generates a line segment:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
<span class="l">20: </span>
<span class="l">21: </span>
<span class="l">22: </span>
<span class="l">23: </span>
<span class="l">24: </span>
<span class="l">25: </span>
<span class="l">26: </span>
<span class="l">27: </span>
<span class="l">28: </span>
<span class="l">29: </span>
<span class="l">30: </span>
<span class="l">31: </span>
<span class="l">32: </span>
<span class="l">33: </span>
<span class="l">34: </span>
<span class="l">35: </span>
<span class="l">36: </span>
<span class="l">37: </span>
<span class="l">38: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="c">/// interprets a logo program and produces a line segment list to render</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs76', 181)" onmouseover="showTip(event, 'fs76', 181)" class="f">processTurtle</span> <span onmouseout="hideTip(event, 'fs77', 182)" onmouseover="showTip(event, 'fs77', 182)" class="i">turtle</span> <span onmouseout="hideTip(event, 'fs78', 183)" onmouseover="showTip(event, 'fs78', 183)" class="i">program</span> <span class="o">=</span>
  <span class="k">let</span> <span class="k">rec</span> <span onmouseout="hideTip(event, 'fs79', 184)" onmouseover="showTip(event, 'fs79', 184)" class="f">phono</span> <span onmouseout="hideTip(event, 'fs80', 185)" onmouseover="showTip(event, 'fs80', 185)" class="i">stack</span> <span onmouseout="hideTip(event, 'fs81', 186)" onmouseover="showTip(event, 'fs81', 186)" class="i">output</span> <span onmouseout="hideTip(event, 'fs77', 187)" onmouseover="showTip(event, 'fs77', 187)" class="i">turtle</span> <span class="o">=</span> <span class="k">function</span>
    | [] <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs81', 188)" onmouseover="showTip(event, 'fs81', 188)" class="i">output</span>
    | <span onmouseout="hideTip(event, 'fs65', 189)" onmouseover="showTip(event, 'fs65', 189)" class="p">RandomColor</span> <span class="o">::</span> <span onmouseout="hideTip(event, 'fs82', 190)" onmouseover="showTip(event, 'fs82', 190)" class="i">t</span> <span class="k">-&gt;</span>
        <span class="c">// Change current color of the turtle</span>
        <span onmouseout="hideTip(event, 'fs79', 191)" onmouseover="showTip(event, 'fs79', 191)" class="f">phono</span> <span onmouseout="hideTip(event, 'fs80', 192)" onmouseover="showTip(event, 'fs80', 192)" class="i">stack</span> <span onmouseout="hideTip(event, 'fs81', 193)" onmouseover="showTip(event, 'fs81', 193)" class="i">output</span> { <span onmouseout="hideTip(event, 'fs77', 194)" onmouseover="showTip(event, 'fs77', 194)" class="i">turtle</span> <span class="k">with</span> <span onmouseout="hideTip(event, 'fs70', 195)" onmouseover="showTip(event, 'fs70', 195)" class="i">c</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs74', 196)" onmouseover="showTip(event, 'fs74', 196)" class="f">randomColor</span>() } <span onmouseout="hideTip(event, 'fs82', 197)" onmouseover="showTip(event, 'fs82', 197)" class="i">t</span>
    | <span onmouseout="hideTip(event, 'fs63', 198)" onmouseover="showTip(event, 'fs63', 198)" class="p">Push</span> <span class="o">::</span> <span onmouseout="hideTip(event, 'fs82', 199)" onmouseover="showTip(event, 'fs82', 199)" class="i">t</span> <span class="k">-&gt;</span>
        <span class="c">// Store current state on the stack</span>
        <span onmouseout="hideTip(event, 'fs79', 200)" onmouseover="showTip(event, 'fs79', 200)" class="f">phono</span> (<span onmouseout="hideTip(event, 'fs77', 201)" onmouseover="showTip(event, 'fs77', 201)" class="i">turtle</span><span class="o">::</span><span onmouseout="hideTip(event, 'fs80', 202)" onmouseover="showTip(event, 'fs80', 202)" class="i">stack</span>) <span onmouseout="hideTip(event, 'fs81', 203)" onmouseover="showTip(event, 'fs81', 203)" class="i">output</span> <span onmouseout="hideTip(event, 'fs77', 204)" onmouseover="showTip(event, 'fs77', 204)" class="i">turtle</span> <span onmouseout="hideTip(event, 'fs82', 205)" onmouseover="showTip(event, 'fs82', 205)" class="i">t</span>
    | <span onmouseout="hideTip(event, 'fs64', 206)" onmouseover="showTip(event, 'fs64', 206)" class="p">Pop</span> <span class="o">::</span> <span onmouseout="hideTip(event, 'fs82', 207)" onmouseover="showTip(event, 'fs82', 207)" class="i">t</span> <span class="k">when</span> <span onmouseout="hideTip(event, 'fs83', 208)" onmouseover="showTip(event, 'fs83', 208)" class="t">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs84', 209)" onmouseover="showTip(event, 'fs84', 209)" class="f">isEmpty</span> <span onmouseout="hideTip(event, 'fs80', 210)" onmouseover="showTip(event, 'fs80', 210)" class="i">stack</span> <span class="k">-&gt;</span>
        <span class="c">// Silently ignore errors when stack is empty</span>
        <span onmouseout="hideTip(event, 'fs79', 211)" onmouseover="showTip(event, 'fs79', 211)" class="f">phono</span> <span onmouseout="hideTip(event, 'fs80', 212)" onmouseover="showTip(event, 'fs80', 212)" class="i">stack</span> <span onmouseout="hideTip(event, 'fs81', 213)" onmouseover="showTip(event, 'fs81', 213)" class="i">output</span> <span onmouseout="hideTip(event, 'fs77', 214)" onmouseover="showTip(event, 'fs77', 214)" class="i">turtle</span> <span onmouseout="hideTip(event, 'fs82', 215)" onmouseover="showTip(event, 'fs82', 215)" class="i">t</span>
    | <span onmouseout="hideTip(event, 'fs64', 216)" onmouseover="showTip(event, 'fs64', 216)" class="p">Pop</span> <span class="o">::</span> <span onmouseout="hideTip(event, 'fs82', 217)" onmouseover="showTip(event, 'fs82', 217)" class="i">t</span> <span class="k">-&gt;</span>
        <span class="c">// Pop the most recent turtle state from the stack</span>
        <span onmouseout="hideTip(event, 'fs79', 218)" onmouseover="showTip(event, 'fs79', 218)" class="f">phono</span> (<span onmouseout="hideTip(event, 'fs83', 219)" onmouseover="showTip(event, 'fs83', 219)" class="t">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs85', 220)" onmouseover="showTip(event, 'fs85', 220)" class="f">tail</span> <span onmouseout="hideTip(event, 'fs80', 221)" onmouseover="showTip(event, 'fs80', 221)" class="i">stack</span>) <span onmouseout="hideTip(event, 'fs81', 222)" onmouseover="showTip(event, 'fs81', 222)" class="i">output</span> (<span onmouseout="hideTip(event, 'fs83', 223)" onmouseover="showTip(event, 'fs83', 223)" class="t">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs86', 224)" onmouseover="showTip(event, 'fs86', 224)" class="f">head</span> <span onmouseout="hideTip(event, 'fs80', 225)" onmouseover="showTip(event, 'fs80', 225)" class="i">stack</span>) <span onmouseout="hideTip(event, 'fs82', 226)" onmouseover="showTip(event, 'fs82', 226)" class="i">t</span>

    | <span onmouseout="hideTip(event, 'fs61', 227)" onmouseover="showTip(event, 'fs61', 227)" class="p">DrawForward</span> <span onmouseout="hideTip(event, 'fs87', 228)" onmouseover="showTip(event, 'fs87', 228)" class="i">d</span> <span class="o">::</span> <span onmouseout="hideTip(event, 'fs82', 229)" onmouseover="showTip(event, 'fs82', 229)" class="i">t</span> <span class="k">-&gt;</span>
        <span class="c">// Move forward by `d` in the current direction</span>
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs88', 230)" onmouseover="showTip(event, 'fs88', 230)" class="i">rads</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs77', 231)" onmouseover="showTip(event, 'fs77', 231)" class="i">turtle</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs67', 232)" onmouseover="showTip(event, 'fs67', 232)" class="i">angle</span> <span class="o">*</span> (<span onmouseout="hideTip(event, 'fs72', 233)" onmouseover="showTip(event, 'fs72', 233)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs89', 234)" onmouseover="showTip(event, 'fs89', 234)" class="t">Math</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs90', 235)" onmouseover="showTip(event, 'fs90', 235)" class="i">PI</span> <span class="o">/</span> <span class="n">180.0</span>)
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs54', 236)" onmouseover="showTip(event, 'fs54', 236)" class="i">x</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs77', 237)" onmouseover="showTip(event, 'fs77', 237)" class="i">turtle</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs68', 238)" onmouseover="showTip(event, 'fs68', 238)" class="i">x</span> <span class="o">+</span> <span onmouseout="hideTip(event, 'fs87', 239)" onmouseover="showTip(event, 'fs87', 239)" class="i">d</span> <span class="o">*</span> <span onmouseout="hideTip(event, 'fs91', 240)" onmouseover="showTip(event, 'fs91', 240)" class="f">cos</span> <span onmouseout="hideTip(event, 'fs88', 241)" onmouseover="showTip(event, 'fs88', 241)" class="i">rads</span>
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs56', 242)" onmouseover="showTip(event, 'fs56', 242)" class="i">y</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs77', 243)" onmouseover="showTip(event, 'fs77', 243)" class="i">turtle</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs69', 244)" onmouseover="showTip(event, 'fs69', 244)" class="i">y</span> <span class="o">+</span> <span onmouseout="hideTip(event, 'fs87', 245)" onmouseover="showTip(event, 'fs87', 245)" class="i">d</span> <span class="o">*</span> <span onmouseout="hideTip(event, 'fs92', 246)" onmouseover="showTip(event, 'fs92', 246)" class="f">sin</span> <span onmouseout="hideTip(event, 'fs88', 247)" onmouseover="showTip(event, 'fs88', 247)" class="i">rads</span>
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs93', 248)" onmouseover="showTip(event, 'fs93', 248)" class="i">newTurtle</span> <span class="o">=</span> {<span onmouseout="hideTip(event, 'fs77', 249)" onmouseover="showTip(event, 'fs77', 249)" class="i">turtle</span> <span class="k">with</span> <span onmouseout="hideTip(event, 'fs68', 250)" onmouseover="showTip(event, 'fs68', 250)" class="i">x</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs54', 251)" onmouseover="showTip(event, 'fs54', 251)" class="i">x</span>; <span onmouseout="hideTip(event, 'fs69', 252)" onmouseover="showTip(event, 'fs69', 252)" class="i">y</span><span class="o">=</span> <span onmouseout="hideTip(event, 'fs56', 253)" onmouseover="showTip(event, 'fs56', 253)" class="i">y</span> }
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs94', 254)" onmouseover="showTip(event, 'fs94', 254)" class="i">seg</span> <span class="o">=</span>
          { <span class="i">startPoint</span> <span class="o">=</span> {<span onmouseout="hideTip(event, 'fs27', 255)" onmouseover="showTip(event, 'fs27', 255)" class="i">x</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs77', 256)" onmouseover="showTip(event, 'fs77', 256)" class="i">turtle</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs68', 257)" onmouseover="showTip(event, 'fs68', 257)" class="i">x</span>; <span onmouseout="hideTip(event, 'fs29', 258)" onmouseover="showTip(event, 'fs29', 258)" class="i">y</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs77', 259)" onmouseover="showTip(event, 'fs77', 259)" class="i">turtle</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs69', 260)" onmouseover="showTip(event, 'fs69', 260)" class="i">y</span>}
            <span class="i">endPoint</span> <span class="o">=</span> {<span onmouseout="hideTip(event, 'fs27', 261)" onmouseover="showTip(event, 'fs27', 261)" class="i">x</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs54', 262)" onmouseover="showTip(event, 'fs54', 262)" class="i">x</span>; <span onmouseout="hideTip(event, 'fs29', 263)" onmouseover="showTip(event, 'fs29', 263)" class="i">y</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs56', 264)" onmouseover="showTip(event, 'fs56', 264)" class="i">y</span>}; <span class="i">color</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs77', 265)" onmouseover="showTip(event, 'fs77', 265)" class="i">turtle</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs70', 266)" onmouseover="showTip(event, 'fs70', 266)" class="i">c</span> }
        <span onmouseout="hideTip(event, 'fs79', 267)" onmouseover="showTip(event, 'fs79', 267)" class="f">phono</span> <span onmouseout="hideTip(event, 'fs80', 268)" onmouseover="showTip(event, 'fs80', 268)" class="i">stack</span> (<span onmouseout="hideTip(event, 'fs94', 269)" onmouseover="showTip(event, 'fs94', 269)" class="i">seg</span><span class="o">::</span><span onmouseout="hideTip(event, 'fs81', 270)" onmouseover="showTip(event, 'fs81', 270)" class="i">output</span>) <span onmouseout="hideTip(event, 'fs93', 271)" onmouseover="showTip(event, 'fs93', 271)" class="i">newTurtle</span> <span onmouseout="hideTip(event, 'fs82', 272)" onmouseover="showTip(event, 'fs82', 272)" class="i">t</span>

    | <span onmouseout="hideTip(event, 'fs62', 273)" onmouseover="showTip(event, 'fs62', 273)" class="p">Turn</span> <span onmouseout="hideTip(event, 'fs95', 274)" onmouseover="showTip(event, 'fs95', 274)" class="i">delta</span> <span class="o">::</span> <span onmouseout="hideTip(event, 'fs82', 275)" onmouseover="showTip(event, 'fs82', 275)" class="i">t</span> <span class="k">-&gt;</span>
        <span class="c">// Rotate by the specified angle</span>
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs87', 276)" onmouseover="showTip(event, 'fs87', 276)" class="i">d</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs77', 277)" onmouseover="showTip(event, 'fs77', 277)" class="i">turtle</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs67', 278)" onmouseover="showTip(event, 'fs67', 278)" class="i">angle</span> <span class="o">+</span> <span onmouseout="hideTip(event, 'fs95', 279)" onmouseover="showTip(event, 'fs95', 279)" class="i">delta</span>
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs87', 280)" onmouseover="showTip(event, 'fs87', 280)" class="i">d</span> <span class="o">=</span>
          <span class="k">if</span> <span onmouseout="hideTip(event, 'fs95', 281)" onmouseover="showTip(event, 'fs95', 281)" class="i">delta</span> <span class="o">&gt;</span> <span class="n">0.0</span> <span class="o">&amp;&amp;</span> <span onmouseout="hideTip(event, 'fs87', 282)" onmouseover="showTip(event, 'fs87', 282)" class="i">d</span> <span class="o">&gt;</span> <span class="n">360.0</span> <span class="k">then</span> <span onmouseout="hideTip(event, 'fs87', 283)" onmouseover="showTip(event, 'fs87', 283)" class="i">d</span> <span class="o">-</span> <span class="n">360.0</span>
          <span class="k">elif</span> <span onmouseout="hideTip(event, 'fs95', 284)" onmouseover="showTip(event, 'fs95', 284)" class="i">delta</span> <span class="o">&lt;</span> <span class="n">0.0</span> <span class="o">&amp;&amp;</span> <span onmouseout="hideTip(event, 'fs87', 285)" onmouseover="showTip(event, 'fs87', 285)" class="i">d</span> <span class="o">&lt;</span> <span class="n">0.0</span> <span class="k">then</span> <span class="n">360.0</span> <span class="o">+</span> <span onmouseout="hideTip(event, 'fs87', 286)" onmouseover="showTip(event, 'fs87', 286)" class="i">d</span>
          <span class="k">else</span> <span onmouseout="hideTip(event, 'fs87', 287)" onmouseover="showTip(event, 'fs87', 287)" class="i">d</span>
        <span onmouseout="hideTip(event, 'fs79', 288)" onmouseover="showTip(event, 'fs79', 288)" class="f">phono</span> <span onmouseout="hideTip(event, 'fs80', 289)" onmouseover="showTip(event, 'fs80', 289)" class="i">stack</span> <span onmouseout="hideTip(event, 'fs81', 290)" onmouseover="showTip(event, 'fs81', 290)" class="i">output</span> {<span onmouseout="hideTip(event, 'fs77', 291)" onmouseover="showTip(event, 'fs77', 291)" class="i">turtle</span> <span class="k">with</span> <span class="i">angle</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs87', 292)" onmouseover="showTip(event, 'fs87', 292)" class="i">d</span>} <span onmouseout="hideTip(event, 'fs82', 293)" onmouseover="showTip(event, 'fs82', 293)" class="i">t</span>

  <span onmouseout="hideTip(event, 'fs83', 294)" onmouseover="showTip(event, 'fs83', 294)" class="t">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs96', 295)" onmouseover="showTip(event, 'fs96', 295)" class="f">rev</span> (<span onmouseout="hideTip(event, 'fs79', 296)" onmouseover="showTip(event, 'fs79', 296)" class="f">phono</span> [] [] <span onmouseout="hideTip(event, 'fs77', 297)" onmouseover="showTip(event, 'fs77', 297)" class="i">turtle</span> <span onmouseout="hideTip(event, 'fs78', 298)" onmouseover="showTip(event, 'fs78', 298)" class="i">program</span>)
</code></pre></td>
</tr>
</table>
<h2><a name="Processing-and-rendering-L-systems" class="anchor" href="#Processing-and-rendering-L-systems">Processing and rendering L-systems</a></h2>
<p>An L-system is represented by an initial state (called an axiom) and a function that returns the
production (new L-system string on the right of <code>-&gt;</code>) for a given character:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">type</span> <span onmouseout="hideTip(event, 'fs97', 299)" onmouseover="showTip(event, 'fs97', 299)" class="t">LSystem</span> <span class="o">=</span>
  { <span onmouseout="hideTip(event, 'fs98', 300)" onmouseover="showTip(event, 'fs98', 300)" class="i">Axiom</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs20', 301)" onmouseover="showTip(event, 'fs20', 301)" class="t">string</span>
    <span onmouseout="hideTip(event, 'fs99', 302)" onmouseover="showTip(event, 'fs99', 302)" class="i">Productions</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs100', 303)" onmouseover="showTip(event, 'fs100', 303)" class="t">char</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs20', 304)" onmouseover="showTip(event, 'fs20', 304)" class="t">string</span> }
</code></pre></td>
</tr>
</table>
<p>When processing an L-system, we start with an initial string and repeatedly (for a given number
of iterations) replace all the characters in the string with a new string produced by the
<code>Productions</code> function. To do this efficiently, we're going to use mutable JavaScript arrays.
In JavaScript, you can call <code>ar.push(x)</code> on an array <code>ar</code> to add an element <code>x</code> to the end of the
array. We can use F# extensions and <code>Emit</code> attribtue to enable calling this member on an F# array
(this is slightly ugly, but it does the trick!):</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
<span class="l">7: </span>
<span class="l">8: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp">[&lt;<span onmouseout="hideTip(event, 'fs1', 20)" onmouseover="showTip(event, 'fs1', 20)" class="i">Fable</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs12', 21)" onmouseover="showTip(event, 'fs12', 21)" class="i">Core</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs13', 22)" onmouseover="showTip(event, 'fs13', 22)" class="t">Emit</span>(<span class="s">&quot;$0.push($1)&quot;</span>)&gt;]
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs14', 23)" onmouseover="showTip(event, 'fs14', 23)" class="f">push</span> (<span onmouseout="hideTip(event, 'fs15', 24)" onmouseover="showTip(event, 'fs15', 24)" class="i">sb</span><span class="o">:</span><span class="o">&#39;</span><span class="i">a</span>[]) (<span onmouseout="hideTip(event, 'fs16', 25)" onmouseover="showTip(event, 'fs16', 25)" class="i">v</span><span class="o">:</span><span class="o">&#39;</span><span class="i">a</span>) <span class="o">=</span> <span onmouseout="hideTip(event, 'fs17', 26)" onmouseover="showTip(event, 'fs17', 26)" class="f">failwith</span> <span class="s">&quot;js&quot;</span>
[&lt;<span onmouseout="hideTip(event, 'fs1', 27)" onmouseover="showTip(event, 'fs1', 27)" class="i">Fable</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs12', 28)" onmouseover="showTip(event, 'fs12', 28)" class="i">Core</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs13', 29)" onmouseover="showTip(event, 'fs13', 29)" class="t">Emit</span>(<span class="s">&quot;$0.join($1)&quot;</span>)&gt;]
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs18', 30)" onmouseover="showTip(event, 'fs18', 30)" class="f">join</span> (<span onmouseout="hideTip(event, 'fs15', 31)" onmouseover="showTip(event, 'fs15', 31)" class="i">sb</span><span class="o">:</span><span class="o">&#39;</span><span class="i">a</span>[]) (<span onmouseout="hideTip(event, 'fs19', 32)" onmouseover="showTip(event, 'fs19', 32)" class="i">sep</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs20', 33)" onmouseover="showTip(event, 'fs20', 33)" class="t">string</span>) <span class="o">=</span> <span onmouseout="hideTip(event, 'fs17', 34)" onmouseover="showTip(event, 'fs17', 34)" class="f">failwith</span> <span class="s">&quot;js&quot;</span>

<span class="k">type</span> <span class="t">``[]``</span><span class="o">&lt;</span><span class="o">&#39;</span><span class="i">a</span><span class="o">&gt;</span> <span class="k">with</span>
  <span class="k">member</span> <span onmouseout="hideTip(event, 'fs21', 35)" onmouseover="showTip(event, 'fs21', 35)" class="i">x</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs22', 36)" onmouseover="showTip(event, 'fs22', 36)" class="f">push</span>(<span onmouseout="hideTip(event, 'fs23', 37)" onmouseover="showTip(event, 'fs23', 37)" class="i">v</span>) <span class="o">=</span> <span onmouseout="hideTip(event, 'fs14', 38)" onmouseover="showTip(event, 'fs14', 38)" class="f">push</span> <span onmouseout="hideTip(event, 'fs21', 39)" onmouseover="showTip(event, 'fs21', 39)" class="i">x</span> <span onmouseout="hideTip(event, 'fs23', 40)" onmouseover="showTip(event, 'fs23', 40)" class="i">v</span>
  <span class="k">member</span> <span onmouseout="hideTip(event, 'fs21', 41)" onmouseover="showTip(event, 'fs21', 41)" class="i">x</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs24', 42)" onmouseover="showTip(event, 'fs24', 42)" class="f">join</span>(<span onmouseout="hideTip(event, 'fs25', 43)" onmouseover="showTip(event, 'fs25', 43)" class="i">s</span>) <span class="o">=</span> <span onmouseout="hideTip(event, 'fs18', 44)" onmouseover="showTip(event, 'fs18', 44)" class="f">join</span> <span onmouseout="hideTip(event, 'fs21', 45)" onmouseover="showTip(event, 'fs21', 45)" class="i">x</span> <span onmouseout="hideTip(event, 'fs25', 46)" onmouseover="showTip(event, 'fs25', 46)" class="i">s</span>
</code></pre></td>
</tr>
</table>
<p>Now we have everything we need to implement a function that processes the L-system:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs101', 305)" onmouseover="showTip(event, 'fs101', 305)" class="f">processLsystem</span> <span onmouseout="hideTip(event, 'fs102', 306)" onmouseover="showTip(event, 'fs102', 306)" class="i">max</span> <span onmouseout="hideTip(event, 'fs103', 307)" onmouseover="showTip(event, 'fs103', 307)" class="i">lsystem</span> <span class="o">=</span>
  <span class="k">let</span> <span class="k">rec</span> <span onmouseout="hideTip(event, 'fs104', 308)" onmouseover="showTip(event, 'fs104', 308)" class="f">gen</span> (<span onmouseout="hideTip(event, 'fs105', 309)" onmouseover="showTip(event, 'fs105', 309)" class="i">current</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs20', 310)" onmouseover="showTip(event, 'fs20', 310)" class="t">string</span>) <span onmouseout="hideTip(event, 'fs106', 311)" onmouseover="showTip(event, 'fs106', 311)" class="i">iteration</span> <span class="o">=</span>
    <span class="k">if</span> <span onmouseout="hideTip(event, 'fs106', 312)" onmouseover="showTip(event, 'fs106', 312)" class="i">iteration</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs102', 313)" onmouseover="showTip(event, 'fs102', 313)" class="i">max</span> <span class="k">then</span> <span onmouseout="hideTip(event, 'fs105', 314)" onmouseover="showTip(event, 'fs105', 314)" class="i">current</span> <span class="k">else</span>
    <span class="c">// Iterate over characters, appending the result of</span>
    <span class="c">// production to the mutable array `sb` of strings</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs15', 315)" onmouseover="showTip(event, 'fs15', 315)" class="i">sb</span> <span class="o">=</span> [||]
    <span class="k">for</span> <span onmouseout="hideTip(event, 'fs107', 316)" onmouseover="showTip(event, 'fs107', 316)" class="i">x</span> <span class="k">in</span> <span onmouseout="hideTip(event, 'fs105', 317)" onmouseover="showTip(event, 'fs105', 317)" class="i">current</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs108', 318)" onmouseover="showTip(event, 'fs108', 318)" class="f">ToCharArray</span>() <span class="k">do</span>
      <span onmouseout="hideTip(event, 'fs15', 319)" onmouseover="showTip(event, 'fs15', 319)" class="i">sb</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs14', 320)" onmouseover="showTip(event, 'fs14', 320)" class="f">push</span>(<span onmouseout="hideTip(event, 'fs103', 321)" onmouseover="showTip(event, 'fs103', 321)" class="i">lsystem</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs99', 322)" onmouseover="showTip(event, 'fs99', 322)" class="i">Productions</span> <span onmouseout="hideTip(event, 'fs107', 323)" onmouseover="showTip(event, 'fs107', 323)" class="i">x</span>)
    <span onmouseout="hideTip(event, 'fs104', 324)" onmouseover="showTip(event, 'fs104', 324)" class="f">gen</span> (<span onmouseout="hideTip(event, 'fs15', 325)" onmouseover="showTip(event, 'fs15', 325)" class="i">sb</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs18', 326)" onmouseover="showTip(event, 'fs18', 326)" class="f">join</span>(<span class="s">&quot;&quot;</span>)) (<span onmouseout="hideTip(event, 'fs106', 327)" onmouseover="showTip(event, 'fs106', 327)" class="i">iteration</span><span class="o">+</span><span class="n">1</span>)

  <span class="c">// Start with the initial axiom</span>
  <span onmouseout="hideTip(event, 'fs104', 328)" onmouseover="showTip(event, 'fs104', 328)" class="f">gen</span> <span onmouseout="hideTip(event, 'fs103', 329)" onmouseover="showTip(event, 'fs103', 329)" class="i">lsystem</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs98', 330)" onmouseover="showTip(event, 'fs98', 330)" class="i">Axiom</span> <span class="n">0</span>
</code></pre></td>
</tr>
</table>
<p>The <code>processLsystem</code> function turns an L-system specification into a single large string that
represents the actions that we want to do. This pretty much directly corresponds to the turtle
commands that we defined earlier:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="c">// By default, go forward by 10 pixels</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs109', 331)" onmouseover="showTip(event, 'fs109', 331)" class="i">defaultLength</span> <span class="o">=</span> <span class="n">10.0</span>

<span class="c">// Convert processed l-system string to turtle commands</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs110', 332)" onmouseover="showTip(event, 'fs110', 332)" class="f">convertToTurtle</span> <span onmouseout="hideTip(event, 'fs111', 333)" onmouseover="showTip(event, 'fs111', 333)" class="i">angle</span> (<span onmouseout="hideTip(event, 'fs112', 334)" onmouseover="showTip(event, 'fs112', 334)" class="i">lSystemString</span><span class="o">:</span> <span onmouseout="hideTip(event, 'fs20', 335)" onmouseover="showTip(event, 'fs20', 335)" class="t">string</span>) <span class="o">=</span>
  <span class="k">let</span> <span onmouseout="hideTip(event, 'fs113', 336)" onmouseover="showTip(event, 'fs113', 336)" class="i">defaultAngle</span> <span class="o">=</span> <span class="n">1.0</span> <span class="o">*</span> <span onmouseout="hideTip(event, 'fs111', 337)" onmouseover="showTip(event, 'fs111', 337)" class="i">angle</span>
  <span onmouseout="hideTip(event, 'fs112', 338)" onmouseover="showTip(event, 'fs112', 338)" class="i">lSystemString</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs108', 339)" onmouseover="showTip(event, 'fs108', 339)" class="f">ToCharArray</span>() <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs114', 340)" onmouseover="showTip(event, 'fs114', 340)" class="t">Array</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs115', 341)" onmouseover="showTip(event, 'fs115', 341)" class="f">map</span> (<span class="k">function</span>
    <span class="c">// Special commands that mean something</span>
    | <span class="s">&#39;+&#39;</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs62', 342)" onmouseover="showTip(event, 'fs62', 342)" class="p">Turn</span>(<span onmouseout="hideTip(event, 'fs113', 343)" onmouseover="showTip(event, 'fs113', 343)" class="i">defaultAngle</span>)
    | <span class="s">&#39;-&#39;</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs62', 344)" onmouseover="showTip(event, 'fs62', 344)" class="p">Turn</span>(<span class="o">-</span><span onmouseout="hideTip(event, 'fs113', 345)" onmouseover="showTip(event, 'fs113', 345)" class="i">defaultAngle</span>)
    | <span class="s">&#39;!&#39;</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs65', 346)" onmouseover="showTip(event, 'fs65', 346)" class="p">RandomColor</span>
    | <span class="s">&#39;[&#39;</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs63', 347)" onmouseover="showTip(event, 'fs63', 347)" class="p">Push</span>
    | <span class="s">&#39;]&#39;</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs64', 348)" onmouseover="showTip(event, 'fs64', 348)" class="p">Pop</span>
    <span class="c">// Anything else is treated as move forward</span>
    | _ <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs61', 349)" onmouseover="showTip(event, 'fs61', 349)" class="p">DrawForward</span>(<span onmouseout="hideTip(event, 'fs109', 350)" onmouseover="showTip(event, 'fs109', 350)" class="i">defaultLength</span>) )
  <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs114', 351)" onmouseover="showTip(event, 'fs114', 351)" class="t">Array</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs116', 352)" onmouseover="showTip(event, 'fs116', 352)" class="f">toList</span>
</code></pre></td>
</tr>
</table>
<h2><a name="Parsing-L-system-specifications" class="anchor" href="#Parsing-L-system-specifications">Parsing L-system specifications</a></h2>
<p>Now we are almost done - we just need to parse the L-system specification given by the user and
then we need to put everything together. There are a number of things that can go wrong when parsing
the specification, so we'll need a function for reporting errors. This uses the HTML library
that we used for generating SVG images:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs117', 353)" onmouseover="showTip(event, 'fs117', 353)" class="f">error</span> <span onmouseout="hideTip(event, 'fs118', 354)" onmouseover="showTip(event, 'fs118', 354)" class="i">msg</span> <span class="o">=</span>
  <span onmouseout="hideTip(event, 'fs119', 355)" onmouseover="showTip(event, 'fs119', 355)" class="i">h</span><span class="o">?</span><span class="i">p</span> [] [
    <span onmouseout="hideTip(event, 'fs119', 356)" onmouseover="showTip(event, 'fs119', 356)" class="i">h</span><span class="o">?</span><span class="i">strong</span> [] [<span onmouseout="hideTip(event, 'fs120', 357)" onmouseover="showTip(event, 'fs120', 357)" class="f">text</span> <span class="s">&quot;Error: &quot;</span>]
    <span onmouseout="hideTip(event, 'fs120', 358)" onmouseover="showTip(event, 'fs120', 358)" class="f">text</span> <span onmouseout="hideTip(event, 'fs118', 359)" onmouseover="showTip(event, 'fs118', 359)" class="i">msg</span>
  ] <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs121', 360)" onmouseover="showTip(event, 'fs121', 360)" class="f">renderTo</span> (<span onmouseout="hideTip(event, 'fs122', 361)" onmouseover="showTip(event, 'fs122', 361)" class="i">document</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs123', 362)" onmouseover="showTip(event, 'fs123', 362)" class="f">getElementById</span>(<span class="s">&quot;errors&quot;</span>))
</code></pre></td>
</tr>
</table>
<p>When parsing an input, we split it into lines. Each line is either an axiom (when it does not
contain <code>-&gt;</code>) or a production rule. When parsing productions, we simply find the part before
<code>-&gt;</code> and after <code>-&gt;</code> and create a function that uses the collected rules to implement mapping
that we can use to construct <code>LSystem</code> value:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
<span class="l">20: </span>
<span class="l">21: </span>
<span class="l">22: </span>
<span class="l">23: </span>
<span class="l">24: </span>
<span class="l">25: </span>
<span class="l">26: </span>
<span class="l">27: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs124', 363)" onmouseover="showTip(event, 'fs124', 363)" class="f">parse</span> (<span onmouseout="hideTip(event, 'fs25', 364)" onmouseover="showTip(event, 'fs25', 364)" class="i">s</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs20', 365)" onmouseover="showTip(event, 'fs20', 365)" class="t">string</span>) <span class="o">=</span>
  <span class="c">// Clear errors and split lines into axioms and procutions</span>
  <span onmouseout="hideTip(event, 'fs119', 366)" onmouseover="showTip(event, 'fs119', 366)" class="i">h</span><span class="o">?</span><span class="i">div</span> [] [] <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs121', 367)" onmouseover="showTip(event, 'fs121', 367)" class="f">renderTo</span> (<span onmouseout="hideTip(event, 'fs122', 368)" onmouseover="showTip(event, 'fs122', 368)" class="i">document</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs123', 369)" onmouseover="showTip(event, 'fs123', 369)" class="f">getElementById</span>(<span class="s">&quot;errors&quot;</span>))
  <span class="k">let</span> <span onmouseout="hideTip(event, 'fs125', 370)" onmouseover="showTip(event, 'fs125', 370)" class="i">prods</span>, <span onmouseout="hideTip(event, 'fs126', 371)" onmouseover="showTip(event, 'fs126', 371)" class="i">ax</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs25', 372)" onmouseover="showTip(event, 'fs25', 372)" class="i">s</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs127', 373)" onmouseover="showTip(event, 'fs127', 373)" class="f">Trim</span>()<span class="o">.</span><span class="f">Split</span>(<span class="s">&#39;\n&#39;</span>) <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs114', 374)" onmouseover="showTip(event, 'fs114', 374)" class="t">Array</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs128', 375)" onmouseover="showTip(event, 'fs128', 375)" class="f">partition</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs25', 376)" onmouseover="showTip(event, 'fs25', 376)" class="i">s</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs25', 377)" onmouseover="showTip(event, 'fs25', 377)" class="i">s</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs129', 378)" onmouseover="showTip(event, 'fs129', 378)" class="f">Contains</span>(<span class="s">&quot;-&gt;&quot;</span>))

  <span class="c">// There shold be exactly one axiom</span>
  <span class="k">let</span> <span onmouseout="hideTip(event, 'fs130', 379)" onmouseover="showTip(event, 'fs130', 379)" class="i">axiom</span> <span class="o">=</span>
    <span class="k">if</span> <span onmouseout="hideTip(event, 'fs126', 380)" onmouseover="showTip(event, 'fs126', 380)" class="i">ax</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs131', 381)" onmouseover="showTip(event, 'fs131', 381)" class="i">Length</span> <span class="o">&lt;&gt;</span> <span class="n">1</span> <span class="k">then</span> <span onmouseout="hideTip(event, 'fs117', 382)" onmouseover="showTip(event, 'fs117', 382)" class="f">error</span>(<span class="s">&quot;There should be exactly one axiom&quot;</span>); <span class="s">&quot;A&quot;</span>
    <span class="k">else</span> <span onmouseout="hideTip(event, 'fs126', 383)" onmouseover="showTip(event, 'fs126', 383)" class="i">ax</span><span class="o">.</span>[<span class="n">0</span>]<span class="o">.</span><span class="f">Trim</span>()

  <span class="c">// Collect production rules</span>
  <span class="k">let</span> <span onmouseout="hideTip(event, 'fs132', 384)" onmouseover="showTip(event, 'fs132', 384)" class="i">prods</span> <span class="o">=</span>
    <span onmouseout="hideTip(event, 'fs132', 385)" onmouseover="showTip(event, 'fs132', 385)" class="i">prods</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs114', 386)" onmouseover="showTip(event, 'fs114', 386)" class="t">Array</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs115', 387)" onmouseover="showTip(event, 'fs115', 387)" class="f">map</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs25', 388)" onmouseover="showTip(event, 'fs25', 388)" class="i">s</span> <span class="k">-&gt;</span>
      <span class="k">let</span> <span onmouseout="hideTip(event, 'fs133', 389)" onmouseover="showTip(event, 'fs133', 389)" class="i">i</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs25', 390)" onmouseover="showTip(event, 'fs25', 390)" class="i">s</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs134', 391)" onmouseover="showTip(event, 'fs134', 391)" class="f">IndexOf</span>(<span class="s">&quot;-&gt;&quot;</span>)
      <span class="k">let</span> <span onmouseout="hideTip(event, 'fs135', 392)" onmouseover="showTip(event, 'fs135', 392)" class="i">c</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs25', 393)" onmouseover="showTip(event, 'fs25', 393)" class="i">s</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs136', 394)" onmouseover="showTip(event, 'fs136', 394)" class="f">Substring</span>(<span class="n">0</span>, <span onmouseout="hideTip(event, 'fs133', 395)" onmouseover="showTip(event, 'fs133', 395)" class="i">i</span>)<span class="o">.</span><span class="f">Trim</span>()
      <span class="k">let</span> <span onmouseout="hideTip(event, 'fs137', 396)" onmouseover="showTip(event, 'fs137', 396)" class="i">c</span> <span class="o">=</span>
        <span class="k">if</span> <span onmouseout="hideTip(event, 'fs135', 397)" onmouseover="showTip(event, 'fs135', 397)" class="i">c</span><span class="o">.</span><span class="i">Length</span> <span class="o">=</span> <span class="n">1</span> <span class="k">then</span> <span onmouseout="hideTip(event, 'fs135', 398)" onmouseover="showTip(event, 'fs135', 398)" class="i">c</span><span class="o">.</span><span class="f">ToCharArray</span>()<span class="o">.</span>[<span class="n">0</span>]
        <span class="k">else</span> <span onmouseout="hideTip(event, 'fs117', 399)" onmouseover="showTip(event, 'fs117', 399)" class="f">error</span>(<span class="s">&quot;Production rule should have one thing on the left&quot;</span>); <span class="s">&#39;A&#39;</span>
      <span class="k">let</span> <span onmouseout="hideTip(event, 'fs138', 400)" onmouseover="showTip(event, 'fs138', 400)" class="i">t</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs25', 401)" onmouseover="showTip(event, 'fs25', 401)" class="i">s</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs136', 402)" onmouseover="showTip(event, 'fs136', 402)" class="f">Substring</span>(<span onmouseout="hideTip(event, 'fs133', 403)" onmouseover="showTip(event, 'fs133', 403)" class="i">i</span><span class="o">+</span><span class="n">2</span>)<span class="o">.</span><span class="f">Trim</span>()
      <span onmouseout="hideTip(event, 'fs137', 404)" onmouseover="showTip(event, 'fs137', 404)" class="i">c</span>, <span onmouseout="hideTip(event, 'fs138', 405)" onmouseover="showTip(event, 'fs138', 405)" class="i">t</span>)

  <span class="c">// Build an L-system specification</span>
  { <span class="i">Axiom</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs130', 406)" onmouseover="showTip(event, 'fs130', 406)" class="i">axiom</span>
    <span class="i">Productions</span> <span class="o">=</span> <span class="k">fun</span> <span onmouseout="hideTip(event, 'fs137', 407)" onmouseover="showTip(event, 'fs137', 407)" class="i">c</span> <span class="k">-&gt;</span>
      <span class="k">match</span> <span onmouseout="hideTip(event, 'fs132', 408)" onmouseover="showTip(event, 'fs132', 408)" class="i">prods</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs114', 409)" onmouseover="showTip(event, 'fs114', 409)" class="t">Array</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs139', 410)" onmouseover="showTip(event, 'fs139', 410)" class="f">tryFind</span> (<span class="k">fun</span> (<span onmouseout="hideTip(event, 'fs140', 411)" onmouseover="showTip(event, 'fs140', 411)" class="i">k</span>, _) <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs140', 412)" onmouseover="showTip(event, 'fs140', 412)" class="i">k</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs137', 413)" onmouseover="showTip(event, 'fs137', 413)" class="i">c</span>) <span class="k">with</span>
      | <span onmouseout="hideTip(event, 'fs141', 414)" onmouseover="showTip(event, 'fs141', 414)" class="p">Some</span>(_, <span onmouseout="hideTip(event, 'fs142', 415)" onmouseover="showTip(event, 'fs142', 415)" class="i">r</span>) <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs142', 416)" onmouseover="showTip(event, 'fs142', 416)" class="i">r</span>
      | _ <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs20', 417)" onmouseover="showTip(event, 'fs20', 417)" class="f">string</span> <span onmouseout="hideTip(event, 'fs137', 418)" onmouseover="showTip(event, 'fs137', 418)" class="i">c</span> }
</code></pre></td>
</tr>
</table>
<h2><a name="Putting-everything-together" class="anchor" href="#Putting-everything-together">Putting everything together</a></h2>
<p>The last step is to implement the user interface. We have a number of elements on the page
that we can access using <code>document.getElementById</code> - for some, we need to access their value,
so we cast them to the appropriate HTML element type:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs143', 419)" onmouseover="showTip(event, 'fs143', 419)" class="i">cont</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs122', 420)" onmouseover="showTip(event, 'fs122', 420)" class="i">document</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs123', 421)" onmouseover="showTip(event, 'fs123', 421)" class="f">getElementById</span>(<span class="s">&quot;output&quot;</span>)
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs144', 422)" onmouseover="showTip(event, 'fs144', 422)" class="i">input</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs122', 423)" onmouseover="showTip(event, 'fs122', 423)" class="i">document</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs123', 424)" onmouseover="showTip(event, 'fs123', 424)" class="f">getElementById</span>(<span class="s">&quot;input&quot;</span>) <span class="o">:?&gt;</span> <span onmouseout="hideTip(event, 'fs145', 425)" onmouseover="showTip(event, 'fs145', 425)" class="t">HTMLTextAreaElement</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs146', 426)" onmouseover="showTip(event, 'fs146', 426)" class="i">iters</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs122', 427)" onmouseover="showTip(event, 'fs122', 427)" class="i">document</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs123', 428)" onmouseover="showTip(event, 'fs123', 428)" class="f">getElementById</span>(<span class="s">&quot;iterations&quot;</span>) <span class="o">:?&gt;</span> <span onmouseout="hideTip(event, 'fs147', 429)" onmouseover="showTip(event, 'fs147', 429)" class="t">HTMLInputElement</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs148', 430)" onmouseover="showTip(event, 'fs148', 430)" class="i">angle</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs122', 431)" onmouseover="showTip(event, 'fs122', 431)" class="i">document</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs123', 432)" onmouseover="showTip(event, 'fs123', 432)" class="f">getElementById</span>(<span class="s">&quot;angle&quot;</span>) <span class="o">:?&gt;</span> <span onmouseout="hideTip(event, 'fs147', 433)" onmouseover="showTip(event, 'fs147', 433)" class="t">HTMLInputElement</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs149', 434)" onmouseover="showTip(event, 'fs149', 434)" class="i">width</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs122', 435)" onmouseover="showTip(event, 'fs122', 435)" class="i">document</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs123', 436)" onmouseover="showTip(event, 'fs123', 436)" class="f">getElementById</span>(<span class="s">&quot;width&quot;</span>) <span class="o">:?&gt;</span> <span onmouseout="hideTip(event, 'fs147', 437)" onmouseover="showTip(event, 'fs147', 437)" class="t">HTMLInputElement</span>
</code></pre></td>
</tr>
</table>
<p>An initial turtle starts in the middle (the position will be re-scaled later, so it does not
matter) and has initially red color:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs150', 438)" onmouseover="showTip(event, 'fs150', 438)" class="i">turtle</span> <span class="o">=</span>
  { <span onmouseout="hideTip(event, 'fs148', 439)" onmouseover="showTip(event, 'fs148', 439)" class="i">angle</span> <span class="o">=</span> <span class="n">0.0</span>; <span onmouseout="hideTip(event, 'fs68', 440)" onmouseover="showTip(event, 'fs68', 440)" class="i">x</span> <span class="o">=</span> <span class="n">0.0</span>; <span onmouseout="hideTip(event, 'fs69', 441)" onmouseover="showTip(event, 'fs69', 441)" class="i">y</span> <span class="o">=</span> <span class="n">0.0</span>
    <span onmouseout="hideTip(event, 'fs70', 442)" onmouseover="showTip(event, 'fs70', 442)" class="i">c</span> <span class="o">=</span> { <span onmouseout="hideTip(event, 'fs31', 443)" onmouseover="showTip(event, 'fs31', 443)" class="i">r</span> <span class="o">=</span> <span class="n">255</span>; <span onmouseout="hideTip(event, 'fs33', 444)" onmouseover="showTip(event, 'fs33', 444)" class="i">g</span> <span class="o">=</span> <span class="n">0</span>; <span onmouseout="hideTip(event, 'fs34', 445)" onmouseover="showTip(event, 'fs34', 445)" class="i">b</span> <span class="o">=</span> <span class="n">0</span> } }
</code></pre></td>
</tr>
</table>
<p>Now the most beautiful part of the source code - the <code>run</code> function just composes all the steps
that we created so far using the <code>|&gt;</code> operator. We take the input, parse it, run the L-system using
the given number of iterations, turn it into Turtle commands, turn that into line segments and
render the line segments:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
<span class="l">7: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs151', 446)" onmouseover="showTip(event, 'fs151', 446)" class="f">run</span> () <span class="o">=</span>
  <span onmouseout="hideTip(event, 'fs124', 447)" onmouseover="showTip(event, 'fs124', 447)" class="f">parse</span> <span onmouseout="hideTip(event, 'fs144', 448)" onmouseover="showTip(event, 'fs144', 448)" class="i">input</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs152', 449)" onmouseover="showTip(event, 'fs152', 449)" class="i">value</span>
  <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs101', 450)" onmouseover="showTip(event, 'fs101', 450)" class="f">processLsystem</span> (<span onmouseout="hideTip(event, 'fs32', 451)" onmouseover="showTip(event, 'fs32', 451)" class="f">int</span> <span onmouseout="hideTip(event, 'fs146', 452)" onmouseover="showTip(event, 'fs146', 452)" class="i">iters</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs153', 453)" onmouseover="showTip(event, 'fs153', 453)" class="i">value</span>)
  <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs110', 454)" onmouseover="showTip(event, 'fs110', 454)" class="f">convertToTurtle</span> (<span onmouseout="hideTip(event, 'fs28', 455)" onmouseover="showTip(event, 'fs28', 455)" class="f">float</span> <span onmouseout="hideTip(event, 'fs148', 456)" onmouseover="showTip(event, 'fs148', 456)" class="i">angle</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs153', 457)" onmouseover="showTip(event, 'fs153', 457)" class="i">value</span>)
  <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs76', 458)" onmouseover="showTip(event, 'fs76', 458)" class="f">processTurtle</span> <span onmouseout="hideTip(event, 'fs150', 459)" onmouseover="showTip(event, 'fs150', 459)" class="i">turtle</span>
  <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs39', 460)" onmouseover="showTip(event, 'fs39', 460)" class="f">render</span> (<span onmouseout="hideTip(event, 'fs32', 461)" onmouseover="showTip(event, 'fs32', 461)" class="f">int</span> <span onmouseout="hideTip(event, 'fs149', 462)" onmouseover="showTip(event, 'fs149', 462)" class="i">width</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs153', 463)" onmouseover="showTip(event, 'fs153', 463)" class="i">value</span>)
  <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs121', 464)" onmouseover="showTip(event, 'fs121', 464)" class="f">renderTo</span> <span onmouseout="hideTip(event, 'fs143', 465)" onmouseover="showTip(event, 'fs143', 465)" class="i">cont</span>
</code></pre></td>
</tr>
</table>
<p>Finally, we call <code>run</code> when any of the configuration parameters change and we also run it when
the page loads:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span onmouseout="hideTip(event, 'fs144', 466)" onmouseover="showTip(event, 'fs144', 466)" class="i">input</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs154', 467)" onmouseover="showTip(event, 'fs154', 467)" class="f">addEventListener_keyup</span>(<span class="k">fun</span> _ <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs151', 468)" onmouseover="showTip(event, 'fs151', 468)" class="f">run</span>(); <span onmouseout="hideTip(event, 'fs155', 469)" onmouseover="showTip(event, 'fs155', 469)" class="f">box</span>())
<span onmouseout="hideTip(event, 'fs146', 470)" onmouseover="showTip(event, 'fs146', 470)" class="i">iters</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs156', 471)" onmouseover="showTip(event, 'fs156', 471)" class="f">addEventListener_change</span>(<span class="k">fun</span> _ <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs151', 472)" onmouseover="showTip(event, 'fs151', 472)" class="f">run</span>(); <span onmouseout="hideTip(event, 'fs155', 473)" onmouseover="showTip(event, 'fs155', 473)" class="f">box</span>())
<span onmouseout="hideTip(event, 'fs148', 474)" onmouseover="showTip(event, 'fs148', 474)" class="i">angle</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs156', 475)" onmouseover="showTip(event, 'fs156', 475)" class="f">addEventListener_change</span>(<span class="k">fun</span> _ <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs151', 476)" onmouseover="showTip(event, 'fs151', 476)" class="f">run</span>(); <span onmouseout="hideTip(event, 'fs155', 477)" onmouseover="showTip(event, 'fs155', 477)" class="f">box</span>())
<span onmouseout="hideTip(event, 'fs149', 478)" onmouseover="showTip(event, 'fs149', 478)" class="i">width</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs156', 479)" onmouseover="showTip(event, 'fs156', 479)" class="f">addEventListener_change</span>(<span class="k">fun</span> _ <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs151', 480)" onmouseover="showTip(event, 'fs151', 480)" class="f">run</span>(); <span onmouseout="hideTip(event, 'fs155', 481)" onmouseover="showTip(event, 'fs155', 481)" class="f">box</span>())
<span onmouseout="hideTip(event, 'fs151', 482)" onmouseover="showTip(event, 'fs151', 482)" class="f">run</span>()
</code></pre></td>
</tr>
</table>


<div class="tip" id="fs1">namespace Fable</div>
<div class="tip" id="fs2">namespace Fable.Import</div>
<div class="tip" id="fs3">module Browser<br /><br />from Fable.Import</div>
<div class="tip" id="fs4">module Html<br /><br />from Fable</div>
<div class="tip" id="fs5">Multiple items<br />module List<br /><br />from Microsoft.FSharp.Collections<br /><br />--------------------<br />type List&lt;&#39;T&gt; =<br />&#160;&#160;| ( [] )<br />&#160;&#160;| ( :: ) of Head: &#39;T * Tail: &#39;T list<br />&#160;&#160;interface IEnumerable<br />&#160;&#160;interface IEnumerable&lt;&#39;T&gt;<br />&#160;&#160;member GetSlice : startIndex:int option * endIndex:int option -&gt; &#39;T list<br />&#160;&#160;member Head : &#39;T<br />&#160;&#160;member IsEmpty : bool<br />&#160;&#160;member Item : index:int -&gt; &#39;T with get<br />&#160;&#160;member Length : int<br />&#160;&#160;member Tail : &#39;T list<br />&#160;&#160;static member Cons : head:&#39;T * tail:&#39;T list -&gt; &#39;T list<br />&#160;&#160;static member Empty : &#39;T list<br /><br />Full name: Microsoft.FSharp.Collections.List&lt;_&gt;</div>
<div class="tip" id="fs6">val rev : l:&#39;a list -&gt; &#39;a list<br /><br />Full name: Lsystem.List.rev</div>
<div class="tip" id="fs7">val l : &#39;a list</div>
<div class="tip" id="fs8">val loop : (&#39;b list -&gt; &#39;b list -&gt; &#39;b list)</div>
<div class="tip" id="fs9">val acc : &#39;b list</div>
<div class="tip" id="fs10">val x : &#39;b</div>
<div class="tip" id="fs11">val xs : &#39;b list</div>
<div class="tip" id="fs12">namespace Fable.Core</div>
<div class="tip" id="fs13">Multiple items<br />type EmitAttribute =<br />&#160;&#160;inherit Attribute<br />&#160;&#160;private new : unit -&gt; EmitAttribute<br />&#160;&#160;new : macro:string -&gt; EmitAttribute<br />&#160;&#160;new : emitterType:Type * methodName:string -&gt; EmitAttribute<br /><br />Full name: Fable.Core.EmitAttribute<br /><br />--------------------<br />new : macro:string -&gt; Fable.Core.EmitAttribute<br />new : emitterType:System.Type * methodName:string -&gt; Fable.Core.EmitAttribute</div>
<div class="tip" id="fs14">val push : sb:&#39;a [] -&gt; v:&#39;a -&gt; &#39;a0<br /><br />Full name: Lsystem.push</div>
<div class="tip" id="fs15">val sb : &#39;a []</div>
<div class="tip" id="fs16">val v : &#39;a</div>
<div class="tip" id="fs17">val failwith : message:string -&gt; &#39;T<br /><br />Full name: Microsoft.FSharp.Core.Operators.failwith</div>
<div class="tip" id="fs18">val join : sb:&#39;a [] -&gt; sep:string -&gt; &#39;a0<br /><br />Full name: Lsystem.join</div>
<div class="tip" id="fs19">val sep : string</div>
<div class="tip" id="fs20">Multiple items<br />val string : value:&#39;T -&gt; string<br /><br />Full name: Microsoft.FSharp.Core.Operators.string<br /><br />--------------------<br />type string = System.String<br /><br />Full name: Microsoft.FSharp.Core.string</div>
<div class="tip" id="fs21">val x : &#39;T []</div>
<div class="tip" id="fs22">member [].push : v:&#39;T -&gt; &#39;a<br /><br />Full name: Lsystem.push</div>
<div class="tip" id="fs23">val v : &#39;T</div>
<div class="tip" id="fs24">member [].join : s:string -&gt; &#39;a<br /><br />Full name: Lsystem.join</div>
<div class="tip" id="fs25">val s : string</div>
<div class="tip" id="fs26">type Point =<br />&#160;&#160;{x: float;<br />&#160;&#160;&#160;y: float;}<br /><br />Full name: Lsystem.Point</div>
<div class="tip" id="fs27">Point.x: float</div>
<div class="tip" id="fs28">Multiple items<br />val float : value:&#39;T -&gt; float (requires member op_Explicit)<br /><br />Full name: Microsoft.FSharp.Core.Operators.float<br /><br />--------------------<br />type float = System.Double<br /><br />Full name: Microsoft.FSharp.Core.float<br /><br />--------------------<br />type float&lt;&#39;Measure&gt; = float<br /><br />Full name: Microsoft.FSharp.Core.float&lt;_&gt;</div>
<div class="tip" id="fs29">Point.y: float</div>
<div class="tip" id="fs30">type Color =<br />&#160;&#160;{r: int;<br />&#160;&#160;&#160;g: int;<br />&#160;&#160;&#160;b: int;}<br /><br />Full name: Lsystem.Color</div>
<div class="tip" id="fs31">Color.r: int</div>
<div class="tip" id="fs32">Multiple items<br />val int : value:&#39;T -&gt; int (requires member op_Explicit)<br /><br />Full name: Microsoft.FSharp.Core.Operators.int<br /><br />--------------------<br />type int = int32<br /><br />Full name: Microsoft.FSharp.Core.int<br /><br />--------------------<br />type int&lt;&#39;Measure&gt; = int<br /><br />Full name: Microsoft.FSharp.Core.int&lt;_&gt;</div>
<div class="tip" id="fs33">Color.g: int</div>
<div class="tip" id="fs34">Color.b: int</div>
<div class="tip" id="fs35">type LineSegment =<br />&#160;&#160;{startPoint: Point;<br />&#160;&#160;&#160;endPoint: Point;<br />&#160;&#160;&#160;color: Color;}<br /><br />Full name: Lsystem.LineSegment</div>
<div class="tip" id="fs36">LineSegment.startPoint: Point</div>
<div class="tip" id="fs37">LineSegment.endPoint: Point</div>
<div class="tip" id="fs38">LineSegment.color: Color</div>
<div class="tip" id="fs39">val render : lineWidth:int -&gt; lines:seq&lt;LineSegment&gt; -&gt; DomNode<br /><br />Full name: Lsystem.render</div>
<div class="tip" id="fs40">val lineWidth : int</div>
<div class="tip" id="fs41">val lines : seq&lt;LineSegment&gt;</div>
<div class="tip" id="fs42">val xs : seq&lt;float&gt;</div>
<div class="tip" id="fs43">module Seq<br /><br />from Microsoft.FSharp.Collections</div>
<div class="tip" id="fs44">val collect : mapping:(&#39;T -&gt; #seq&lt;&#39;U&gt;) -&gt; source:seq&lt;&#39;T&gt; -&gt; seq&lt;&#39;U&gt;<br /><br />Full name: Microsoft.FSharp.Collections.Seq.collect</div>
<div class="tip" id="fs45">val l : LineSegment</div>
<div class="tip" id="fs46">val ys : seq&lt;float&gt;</div>
<div class="tip" id="fs47">val minx : float</div>
<div class="tip" id="fs48">val maxx : float</div>
<div class="tip" id="fs49">val min : source:seq&lt;&#39;T&gt; -&gt; &#39;T (requires comparison)<br /><br />Full name: Microsoft.FSharp.Collections.Seq.min</div>
<div class="tip" id="fs50">val max : source:seq&lt;&#39;T&gt; -&gt; &#39;T (requires comparison)<br /><br />Full name: Microsoft.FSharp.Collections.Seq.max</div>
<div class="tip" id="fs51">val miny : float</div>
<div class="tip" id="fs52">val maxy : float</div>
<div class="tip" id="fs53">val convx : (float -&gt; float)</div>
<div class="tip" id="fs54">val x : float</div>
<div class="tip" id="fs55">val convy : (float -&gt; float)</div>
<div class="tip" id="fs56">val y : float</div>
<div class="tip" id="fs57">val s : El<br /><br />Full name: Fable.Html.s</div>
<div class="tip" id="fs58">val line : LineSegment</div>
<div class="tip" id="fs59">val sprintf : format:Printf.StringFormat&lt;&#39;T&gt; -&gt; &#39;T<br /><br />Full name: Microsoft.FSharp.Core.ExtraTopLevelOperators.sprintf</div>
<div class="tip" id="fs60">type LogoCommand =<br />&#160;&#160;| DrawForward of float<br />&#160;&#160;| Turn of float<br />&#160;&#160;| Push<br />&#160;&#160;| Pop<br />&#160;&#160;| RandomColor<br /><br />Full name: Lsystem.LogoCommand</div>
<div class="tip" id="fs61">union case LogoCommand.DrawForward: float -&gt; LogoCommand</div>
<div class="tip" id="fs62">union case LogoCommand.Turn: float -&gt; LogoCommand</div>
<div class="tip" id="fs63">union case LogoCommand.Push: LogoCommand</div>
<div class="tip" id="fs64">union case LogoCommand.Pop: LogoCommand</div>
<div class="tip" id="fs65">union case LogoCommand.RandomColor: LogoCommand</div>
<div class="tip" id="fs66">type LTurtle =<br />&#160;&#160;{angle: float;<br />&#160;&#160;&#160;x: float;<br />&#160;&#160;&#160;y: float;<br />&#160;&#160;&#160;c: Color;}<br /><br />Full name: Lsystem.LTurtle</div>
<div class="tip" id="fs67">LTurtle.angle: float</div>
<div class="tip" id="fs68">LTurtle.x: float</div>
<div class="tip" id="fs69">LTurtle.y: float</div>
<div class="tip" id="fs70">LTurtle.c: Color</div>
<div class="tip" id="fs71">val chaos : System.Random<br /><br />Full name: Lsystem.chaos</div>
<div class="tip" id="fs72">namespace System</div>
<div class="tip" id="fs73">Multiple items<br />type Random =<br />&#160;&#160;new : unit -&gt; Random + 1 overload<br />&#160;&#160;member Next : unit -&gt; int + 2 overloads<br />&#160;&#160;member NextBytes : buffer:byte[] -&gt; unit<br />&#160;&#160;member NextDouble : unit -&gt; float<br /><br />Full name: System.Random<br /><br />--------------------<br />System.Random() : unit<br />System.Random(Seed: int) : unit</div>
<div class="tip" id="fs74">val randomColor : unit -&gt; Color<br /><br />Full name: Lsystem.randomColor</div>
<div class="tip" id="fs75">System.Random.Next() : int<br />System.Random.Next(maxValue: int) : int<br />System.Random.Next(minValue: int, maxValue: int) : int</div>
<div class="tip" id="fs76">val processTurtle : turtle:LTurtle -&gt; program:LogoCommand list -&gt; LineSegment list<br /><br />Full name: Lsystem.processTurtle<br /><em><br /><br />&#160;interprets a logo program and produces a line segment list to render</em></div>
<div class="tip" id="fs77">val turtle : LTurtle</div>
<div class="tip" id="fs78">val program : LogoCommand list</div>
<div class="tip" id="fs79">val phono : (LTurtle list -&gt; LineSegment list -&gt; LTurtle -&gt; LogoCommand list -&gt; LineSegment list)</div>
<div class="tip" id="fs80">val stack : LTurtle list</div>
<div class="tip" id="fs81">val output : LineSegment list</div>
<div class="tip" id="fs82">val t : LogoCommand list</div>
<div class="tip" id="fs83">Multiple items<br />module List<br /><br />from Lsystem<br /><br />--------------------<br />module List<br /><br />from Microsoft.FSharp.Collections<br /><br />--------------------<br />type List&lt;&#39;T&gt; =<br />&#160;&#160;| ( [] )<br />&#160;&#160;| ( :: ) of Head: &#39;T * Tail: &#39;T list<br />&#160;&#160;interface IEnumerable<br />&#160;&#160;interface IEnumerable&lt;&#39;T&gt;<br />&#160;&#160;member GetSlice : startIndex:int option * endIndex:int option -&gt; &#39;T list<br />&#160;&#160;member Head : &#39;T<br />&#160;&#160;member IsEmpty : bool<br />&#160;&#160;member Item : index:int -&gt; &#39;T with get<br />&#160;&#160;member Length : int<br />&#160;&#160;member Tail : &#39;T list<br />&#160;&#160;static member Cons : head:&#39;T * tail:&#39;T list -&gt; &#39;T list<br />&#160;&#160;static member Empty : &#39;T list<br /><br />Full name: Microsoft.FSharp.Collections.List&lt;_&gt;</div>
<div class="tip" id="fs84">val isEmpty : list:&#39;T list -&gt; bool<br /><br />Full name: Microsoft.FSharp.Collections.List.isEmpty</div>
<div class="tip" id="fs85">val tail : list:&#39;T list -&gt; &#39;T list<br /><br />Full name: Microsoft.FSharp.Collections.List.tail</div>
<div class="tip" id="fs86">val head : list:&#39;T list -&gt; &#39;T<br /><br />Full name: Microsoft.FSharp.Collections.List.head</div>
<div class="tip" id="fs87">val d : float</div>
<div class="tip" id="fs88">val rads : float</div>
<div class="tip" id="fs89">type Math =<br />&#160;&#160;static val PI : float<br />&#160;&#160;static val E : float<br />&#160;&#160;static member Abs : value:sbyte -&gt; sbyte + 6 overloads<br />&#160;&#160;static member Acos : d:float -&gt; float<br />&#160;&#160;static member Asin : d:float -&gt; float<br />&#160;&#160;static member Atan : d:float -&gt; float<br />&#160;&#160;static member Atan2 : y:float * x:float -&gt; float<br />&#160;&#160;static member BigMul : a:int * b:int -&gt; int64<br />&#160;&#160;static member Ceiling : d:decimal -&gt; decimal + 1 overload<br />&#160;&#160;static member Cos : d:float -&gt; float<br />&#160;&#160;...<br /><br />Full name: System.Math</div>
<div class="tip" id="fs90">field System.Math.PI = 3.14159265359</div>
<div class="tip" id="fs91">val cos : value:&#39;T -&gt; &#39;T (requires member Cos)<br /><br />Full name: Microsoft.FSharp.Core.Operators.cos</div>
<div class="tip" id="fs92">val sin : value:&#39;T -&gt; &#39;T (requires member Sin)<br /><br />Full name: Microsoft.FSharp.Core.Operators.sin</div>
<div class="tip" id="fs93">val newTurtle : LTurtle</div>
<div class="tip" id="fs94">val seg : LineSegment</div>
<div class="tip" id="fs95">val delta : float</div>
<div class="tip" id="fs96">Multiple items<br />val rev : l:&#39;a list -&gt; &#39;a list<br /><br />Full name: Lsystem.List.rev<br /><br />--------------------<br />val rev : list:&#39;T list -&gt; &#39;T list<br /><br />Full name: Microsoft.FSharp.Collections.List.rev</div>
<div class="tip" id="fs97">type LSystem =<br />&#160;&#160;{Axiom: string;<br />&#160;&#160;&#160;Productions: char -&gt; string;}<br /><br />Full name: Lsystem.LSystem</div>
<div class="tip" id="fs98">LSystem.Axiom: string</div>
<div class="tip" id="fs99">LSystem.Productions: char -&gt; string</div>
<div class="tip" id="fs100">Multiple items<br />val char : value:&#39;T -&gt; char (requires member op_Explicit)<br /><br />Full name: Microsoft.FSharp.Core.Operators.char<br /><br />--------------------<br />type char = System.Char<br /><br />Full name: Microsoft.FSharp.Core.char</div>
<div class="tip" id="fs101">val processLsystem : max:int -&gt; lsystem:LSystem -&gt; string<br /><br />Full name: Lsystem.processLsystem</div>
<div class="tip" id="fs102">val max : int</div>
<div class="tip" id="fs103">val lsystem : LSystem</div>
<div class="tip" id="fs104">val gen : (string -&gt; int -&gt; string)</div>
<div class="tip" id="fs105">val current : string</div>
<div class="tip" id="fs106">val iteration : int</div>
<div class="tip" id="fs107">val x : char</div>
<div class="tip" id="fs108">System.String.ToCharArray() : char []<br />System.String.ToCharArray(startIndex: int, length: int) : char []</div>
<div class="tip" id="fs109">val defaultLength : float<br /><br />Full name: Lsystem.defaultLength</div>
<div class="tip" id="fs110">val convertToTurtle : angle:float -&gt; lSystemString:string -&gt; LogoCommand list<br /><br />Full name: Lsystem.convertToTurtle</div>
<div class="tip" id="fs111">val angle : float</div>
<div class="tip" id="fs112">val lSystemString : string</div>
<div class="tip" id="fs113">val defaultAngle : float</div>
<div class="tip" id="fs114">module Array<br /><br />from Microsoft.FSharp.Collections</div>
<div class="tip" id="fs115">val map : mapping:(&#39;T -&gt; &#39;U) -&gt; array:&#39;T [] -&gt; &#39;U []<br /><br />Full name: Microsoft.FSharp.Collections.Array.map</div>
<div class="tip" id="fs116">val toList : array:&#39;T [] -&gt; &#39;T list<br /><br />Full name: Microsoft.FSharp.Collections.Array.toList</div>
<div class="tip" id="fs117">val error : msg:string -&gt; unit<br /><br />Full name: Lsystem.error</div>
<div class="tip" id="fs118">val msg : string</div>
<div class="tip" id="fs119">val h : El<br /><br />Full name: Fable.Html.h</div>
<div class="tip" id="fs120">val text : s:string -&gt; DomNode<br /><br />Full name: Fable.Html.text</div>
<div class="tip" id="fs121">val renderTo : node:HTMLElement -&gt; dom:DomNode -&gt; unit<br /><br />Full name: Fable.Html.renderTo</div>
<div class="tip" id="fs122">val document : Document<br /><br />Full name: Fable.Import.Browser.document</div>
<div class="tip" id="fs123">abstract member Document.getElementById : elementId:string -&gt; HTMLElement</div>
<div class="tip" id="fs124">val parse : s:string -&gt; LSystem<br /><br />Full name: Lsystem.parse</div>
<div class="tip" id="fs125">val prods : string []</div>
<div class="tip" id="fs126">val ax : string []</div>
<div class="tip" id="fs127">System.String.Trim() : string<br />System.String.Trim([&lt;System.ParamArray&gt;] trimChars: char []) : string</div>
<div class="tip" id="fs128">val partition : predicate:(&#39;T -&gt; bool) -&gt; array:&#39;T [] -&gt; &#39;T [] * &#39;T []<br /><br />Full name: Microsoft.FSharp.Collections.Array.partition</div>
<div class="tip" id="fs129">System.String.Contains(value: string) : bool</div>
<div class="tip" id="fs130">val axiom : string</div>
<div class="tip" id="fs131">property System.Array.Length: int</div>
<div class="tip" id="fs132">val prods : (char * string) []</div>
<div class="tip" id="fs133">val i : int</div>
<div class="tip" id="fs134">System.String.IndexOf(value: string) : int<br />System.String.IndexOf(value: char) : int<br />System.String.IndexOf(value: string, comparisonType: System.StringComparison) : int<br />System.String.IndexOf(value: string, startIndex: int) : int<br />System.String.IndexOf(value: char, startIndex: int) : int<br />System.String.IndexOf(value: char, startIndex: int, count: int) : int<br />System.String.IndexOf(value: string, startIndex: int, comparisonType: System.StringComparison) : int<br />System.String.IndexOf(value: string, startIndex: int, count: int) : int<br />System.String.IndexOf(value: string, startIndex: int, count: int, comparisonType: System.StringComparison) : int</div>
<div class="tip" id="fs135">val c : string</div>
<div class="tip" id="fs136">System.String.Substring(startIndex: int) : string<br />System.String.Substring(startIndex: int, length: int) : string</div>
<div class="tip" id="fs137">val c : char</div>
<div class="tip" id="fs138">val t : string</div>
<div class="tip" id="fs139">val tryFind : predicate:(&#39;T -&gt; bool) -&gt; array:&#39;T [] -&gt; &#39;T option<br /><br />Full name: Microsoft.FSharp.Collections.Array.tryFind</div>
<div class="tip" id="fs140">val k : char</div>
<div class="tip" id="fs141">union case Option.Some: Value: &#39;T -&gt; Option&lt;&#39;T&gt;</div>
<div class="tip" id="fs142">val r : string</div>
<div class="tip" id="fs143">val cont : HTMLElement<br /><br />Full name: Lsystem.cont</div>
<div class="tip" id="fs144">val input : HTMLTextAreaElement<br /><br />Full name: Lsystem.input</div>
<div class="tip" id="fs145">Multiple items<br />val HTMLTextAreaElement : HTMLTextAreaElementType<br /><br />Full name: Fable.Import.Browser.HTMLTextAreaElement<br /><br />--------------------<br />type HTMLTextAreaElement =<br />&#160;&#160;interface<br />&#160;&#160;&#160;&#160;inherit HTMLElement<br />&#160;&#160;&#160;&#160;abstract member checkValidity : unit -&gt; bool<br />&#160;&#160;&#160;&#160;abstract member createTextRange : unit -&gt; TextRange<br />&#160;&#160;&#160;&#160;abstract member autofocus : bool<br />&#160;&#160;&#160;&#160;abstract member cols : float<br />&#160;&#160;&#160;&#160;abstract member defaultValue : string<br />&#160;&#160;&#160;&#160;abstract member disabled : bool<br />&#160;&#160;&#160;&#160;abstract member form : HTMLFormElement<br />&#160;&#160;&#160;&#160;abstract member maxLength : float<br />&#160;&#160;&#160;&#160;abstract member name : string<br />&#160;&#160;&#160;&#160;...<br />&#160;&#160;end<br /><br />Full name: Fable.Import.Browser.HTMLTextAreaElement</div>
<div class="tip" id="fs146">val iters : HTMLInputElement<br /><br />Full name: Lsystem.iters</div>
<div class="tip" id="fs147">Multiple items<br />val HTMLInputElement : HTMLInputElementType<br /><br />Full name: Fable.Import.Browser.HTMLInputElement<br /><br />--------------------<br />type HTMLInputElement =<br />&#160;&#160;interface<br />&#160;&#160;&#160;&#160;inherit HTMLElement<br />&#160;&#160;&#160;&#160;abstract member checkValidity : unit -&gt; bool<br />&#160;&#160;&#160;&#160;abstract member createTextRange : unit -&gt; TextRange<br />&#160;&#160;&#160;&#160;abstract member accept : string<br />&#160;&#160;&#160;&#160;abstract member align : string<br />&#160;&#160;&#160;&#160;abstract member alt : string<br />&#160;&#160;&#160;&#160;abstract member autocomplete : string<br />&#160;&#160;&#160;&#160;abstract member autofocus : bool<br />&#160;&#160;&#160;&#160;abstract member border : string<br />&#160;&#160;&#160;&#160;abstract member checked : bool<br />&#160;&#160;&#160;&#160;...<br />&#160;&#160;end<br /><br />Full name: Fable.Import.Browser.HTMLInputElement</div>
<div class="tip" id="fs148">val angle : HTMLInputElement<br /><br />Full name: Lsystem.angle</div>
<div class="tip" id="fs149">val width : HTMLInputElement<br /><br />Full name: Lsystem.width</div>
<div class="tip" id="fs150">val turtle : LTurtle<br /><br />Full name: Lsystem.turtle</div>
<div class="tip" id="fs151">val run : unit -&gt; unit<br /><br />Full name: Lsystem.run</div>
<div class="tip" id="fs152">property HTMLTextAreaElement.value: string</div>
<div class="tip" id="fs153">property HTMLInputElement.value: string</div>
<div class="tip" id="fs154">abstract member HTMLElement.addEventListener_keyup : listener:System.Func&lt;KeyboardEvent,obj&gt; * ?useCapture:bool -&gt; unit</div>
<div class="tip" id="fs155">val box : value:&#39;T -&gt; obj<br /><br />Full name: Microsoft.FSharp.Core.Operators.box</div>
<div class="tip" id="fs156">abstract member HTMLElement.addEventListener_change : listener:System.Func&lt;Event,obj&gt; * ?useCapture:bool -&gt; unit</div>

    </div>
    <div class="col-md-1 col-lg-2"></div>
  </div>
</div>

  </div>

  <a class="gh-forkme" href="https://github.com/fsprojects/Fable"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"></a>
</body>
</html>
